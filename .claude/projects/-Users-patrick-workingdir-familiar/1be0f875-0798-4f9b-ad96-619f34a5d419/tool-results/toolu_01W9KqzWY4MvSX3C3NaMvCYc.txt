     1→import React, { useState, useEffect } from 'react';
     2→import { clsx } from 'clsx';
     3→import { useAgents } from '../../context/AgentContext';
     4→import { useQuery, useQueryClient } from '@tanstack/react-query';
     5→import { Zap, Plus, Loader2 } from 'lucide-react';
     6→import { api, type Skill } from '../../lib/api';
     7→import { useNavigate } from 'react-router-dom';
     8→import { ask } from '@tauri-apps/plugin-dialog';
     9→import { open } from '@tauri-apps/plugin-shell';
    10→
    11→export const SkillsView: React.FC = () => {
    12→  const { listSkills, deleteSkill, isExplorerCollapsed, agents, createAgent, selectAgent, setSidebarCollapsed } = useAgents();
    13→  const navigate = useNavigate();
    14→  const queryClient = useQueryClient();
    15→  const [contextMenu, setContextMenu] = useState<{ x: number, y: number, skillName: string } | null>(null);
    16→  const [isCreating, setIsCreating] = useState<string | null>(null);
    17→
    18→  useEffect(() => {
    19→    const handleClick = () => setContextMenu(null);
    20→    window.addEventListener('click', handleClick);
    21→    return () => window.removeEventListener('click', handleClick);
    22→  }, []);
    23→
    24→  const handleContextMenu = (e: React.MouseEvent, skillName: string) => {
    25→    e.preventDefault();
    26→    setContextMenu({ x: e.clientX, y: e.clientY, skillName });
    27→  };
    28→
    29→  const { data: config } = useQuery({
    30→    queryKey: ['config'],
    31→    queryFn: () => api.getConfig(),
    32→  });
    33→
    34→  const { data: skillsData, isLoading: skillsLoading } = useQuery({
    35→    queryKey: ['skills'],
    36→    queryFn: async () => {
    37→      const resp = await listSkills();
    38→      return Array.isArray(resp?.skills) ? resp.skills : [];
    39→    }
    40→  });
    41→
    42→  const handleSkillClick = async (skill: Skill) => {
    43→    // Find if there's an existing Skill Architect agent for this skill
    44→    const architect = Object.values(agents).find(a =>
    45→      a.name === `Skill Architect: ${skill.name}` &&
    46→      !a.is_internal
    47→    );
    48→
    49→    if (architect) {
    50→      selectAgent(architect.id);
    51→      navigate(`/agent/${architect.id}`);
    52→      return;
    53→    }
    54→
    55→    setIsCreating(skill.name);
    56→    try {
    57→      const response = await createAgent(
    58→        { provider: config?.inference?.chat?.provider, model: config?.inference?.chat?.model },
    59→        '',
    60→        { is_skill_creator: true, skill_id: skill.name }
    61→      );
    62→      if (response && response.id) {
    63→        setSidebarCollapsed(true);
    64→        selectAgent(response.id);
    65→        navigate(`/agent/${response.id}`);
    66→      }
    67→    } catch (err) {
    68→      console.error('Failed to create skill architect:', err);
    69→    } finally {
    70→      setIsCreating(null);
    71→    }
    72→  };
    73→
    74→  const handleAction = async (name: string, action: 'edit' | 'open' | 'delete') => {
    75→    const skill = skillsData?.find((s: Skill) => s.name === name);
    76→    if (!skill) return;
    77→
    78→    switch (action) {
    79→      case 'edit':
    80→        handleSkillClick(skill);
    81→        break;
    82→      case 'open':
    83→        if (skill.path) {
    84→          try {
    85→            // Open the parent directory of the skill
    86→            const parentPath = skill.path.substring(0, skill.path.lastIndexOf('/'));
    87→            await api.openPath(parentPath);
    88→          } catch (err) {
    89→            console.error('Failed to open finder:', err);
    90→          }
    91→        }
    92→        break;
    93→      case 'delete':
    94→        const confirmed = await ask(`Are you sure you want to delete the skill "/${name}"? This will permanently remove the skill files from your library. This cannot be undone.`, {
    95→          title: 'Delete Skill',
    96→          kind: 'warning',
    97→        });
    98→        if (confirmed) {
    99→          await deleteSkill(name);
   100→          queryClient.invalidateQueries({ queryKey: ['skills'] });
   101→        }
   102→        break;
   103→    }
   104→  };
   105→
   106→  return (
   107→    <div className="flex flex-col h-full bg-background font-mono text-[12px] relative overflow-hidden select-none">
   108→      {/* ... Skills Header ... */}
   109→      <div className="flex items-center justify-between px-4 py-2 border-b border-border/20 bg-surface/5 shrink-0 font-mono">
   110→        <div className="flex items-center gap-3">
   111→          <h1 className="text-[11px] font-black text-accent uppercase tracking-[0.25em]">
   112→            {isExplorerCollapsed ? '/SKILLS ' : null}
   113→            <span className={clsx("text-text-tertiary opacity-30 font-black", isExplorerCollapsed ? "ml-1" : "ml-0")}>
   114→              [ {skillsData?.length || 0} MODULES ]
   115→            </span>
   116→          </h1>
   117→        </div>
   118→
   119→        <div className="flex items-center gap-4">
   120→        </div>
   121→      </div>
   122→
   123→      <div className="flex-1 overflow-auto p-1 custom-scrollbar">
   124→        <div className="w-full font-mono">
   125→          <div className="sticky top-0 z-10 grid grid-cols-[200px_1fr] gap-2 px-4 py-1.5 bg-background border-b border-border/40 text-[9px] font-black text-text-tertiary uppercase tracking-widest shadow-sm">
   126→            <div>/SKILL_ID</div>
   127→            <div>/DESCRIPTION</div>
   128→          </div>
   129→
   130→          <div className="flex flex-col">
   131→            {skillsLoading ? (
   132→              <div className="px-4 py-12 text-center">
   133→                <div className="flex flex-col items-center gap-2 text-text-tertiary/20">
   134→                  <div className="w-6 h-6 border-2 border-current border-t-transparent rounded-full animate-spin" />
   135→                  <span className="uppercase tracking-[0.2em] text-[9px] font-black">[ SYNCING_NODES... ]</span>
   136→                </div>
   137→              </div>
   138→            ) : skillsData?.length === 0 ? (
   139→              <div className="px-4 py-12 text-center text-text-tertiary/30 uppercase tracking-[0.3em] text-[9px] font-black">
   140→                [ NO_ACTIVE_SKILLS_FOUND ]
   141→              </div>
   142→            ) : (
   143→              [...skillsData]
   144→                .sort((a, b) => (a?.name || '').localeCompare(b?.name || ''))
   145→                .map((skill: Skill) => (
   146→                  <div
   147→                    key={skill.name}
   148→                    onClick={() => handleSkillClick(skill)}
   149→                    onContextMenu={(e) => handleContextMenu(e, skill.name)}
   150→                    className={clsx(
   151→                      "grid grid-cols-[200px_1fr] gap-2 px-4 py-1 border-b border-border/5 hover:bg-surface/30 transition-all items-start group cursor-pointer",
   152→                      isCreating === skill.name && "opacity-50 pointer-events-none"
   153→                    )}
   154→                  >
   155→                    <div className="flex items-center gap-2 text-text-primary font-black uppercase tracking-tighter text-[10px]">
   156→                      {isCreating === skill.name ? (
   157→                        <div className="w-2.5 h-2.5 border border-current border-t-transparent rounded-full animate-spin" />
   158→                      ) : (
   159→                        <span>/</span>
   160→                      )}
   161→                      {skill.name}
   162→                    </div>
   163→                    <div className="text-text-secondary opacity-50 text-[10px] leading-relaxed uppercase tracking-tight font-black">
   164→                      {skill.description}
   165→                    </div>
   166→                  </div>
   167→                ))
   168→            )}
   169→          </div>
   170→        </div>
   171→      </div>
   172→
   173→      {contextMenu && (
   174→        <div
   175→          className="fixed z-[100] w-44 bg-[#0a0a0a] border border-[#333] font-mono text-[10px] overflow-hidden animate-in fade-in duration-75"
   176→          style={{ top: contextMenu.y, left: contextMenu.x }}
   177→          onClick={(e) => e.stopPropagation()}
   178→        >
   179→          <div className="px-2 py-1 border-b border-[#333] bg-[#111] text-[#666]">
   180→            <span className="text-[8px] tracking-wider">
   181→              *** /{contextMenu.skillName}
   182→            </span>
   183→          </div>
   184→
   185→          <button
   186→            className="w-full text-left px-2 py-1.5 text-[#0f0] hover:bg-[#0f0]/10 hover:text-[#0f0] transition-colors border-b border-[#222]"
   187→            onClick={() => {
   188→              handleAction(contextMenu.skillName, 'edit');
   189→              setContextMenu(null);
   190→            }}
   191→          >
   192→            EDIT
   193→          </button>
   194→
   195→          <button
   196→            className="w-full text-left px-2 py-1.5 text-[#0f0] hover:bg-[#0f0]/10 hover:text-[#0f0] transition-colors border-b border-[#222]"
   197→            onClick={() => {
   198→              handleAction(contextMenu.skillName, 'open');
   199→              setContextMenu(null);
   200→            }}
   201→          >
   202→            OPEN
   203→          </button>
   204→
   205→          <button
   206→            className="w-full text-left px-2 py-1.5 text-[#f44] hover:bg-[#f44]/10 hover:text-[#f44] transition-colors"
   207→            onClick={() => {
   208→              handleAction(contextMenu.skillName, 'delete');
   209→              setContextMenu(null);
   210→            }}
   211→          >
   212→            DELETE
   213→          </button>
   214→        </div>
   215→      )}
   216→    </div>
   217→  );
   218→};
   219→
   220→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
